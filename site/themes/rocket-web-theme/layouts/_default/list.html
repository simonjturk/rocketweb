{{ define "main" }}
{{$dir := .Page.File.Dir}}
{{$widgetsPath := printf "%s%s" $dir "widgets"}}

{{$widgetHeadless := .Site.GetPage $widgetsPath}}

{{ $page := . }}
{{ range where (readDir (print "content/" .File.Dir)) ".IsDir" true }}
{{ $widgetHeadless := $page.GetPage .Name }}
{{ $widgets := $widgetHeadless.Resources.ByType "page" }}
{{range sort ( $widgets) "Params.sort" "asc"}}

{{$partial := printf "%s%s%s" "widgets/" .Params.widget ".html"}}

<!--
dir: {{$dir}} </br>
widgetsPath: {{$widgetsPath}} </br>
widget: {{.Params.widget}} </br>

partial: {{$partial}}</br>

-->
{{if isset .Params "widget"}}
{{partial $partial .}}
{{end}}
{{end}}
{{ end }}









{{ .Content }}

{{ if (eq .Params.showChildren true) }}

<div class="flex flex-wrap -mx-1 overflow-hidden">
    {{ range .Pages }}
    <div class="my-1 px-1 w-full overflow-hidden md:w-1/2 xl:w-1/3">
        <!-- Article -->
        <article class="overflow-hidden rounded-lg ">

            <a href="#">
                <img alt="Placeholder" class="block h-auto w-full" src="https://picsum.photos/600/400/?random">
            </a>

            <header class="flex items-center justify-between leading-tight p-2 md:p-4 bg-white">
                <h1 class="text-lg">
                    <a class="no-underline hover:underline text-black" href="#">
                        {{.Title}}
                    </a>
                </h1>
                <p class="text-grey-darker text-sm">
                    11/1/19
                </p>
            </header>

            <footer class="flex items-center justify-between leading-none p-2 md:p-4 bg-white">
                <a class="flex items-center no-underline hover:underline text-black" href="#">
                    Summary
                    <p class="ml-2 text-sm">

                    </p>
                </a>
                <a class="no-underline text-red-600 hover:text-red-dark" href="#">
                    <span class="hidden">Like</span>
                    <i class="fa fa-heart"></i>
                </a>
            </footer>

        </article>
        <!-- END Article -->
    </div>
    {{ end }}
</div>


{{end}}
{{ end }}